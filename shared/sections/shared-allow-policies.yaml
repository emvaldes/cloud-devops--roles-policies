## -------------------------------------------------------------------------- ##
## 1 - Infrastructure

          ## -------------------------------------------------------------------
          ## IAM: permit CFN to assume only CFN exec roles (boundary enforces CFN-only)
          ## -------------------------------------------------------------------
          - Sid: PassRoleForCloudFormationExecRoles
            Effect: Allow
            Action: iam:PassRole  ## allow passing exec roles to CFN
            Resource:
              - arn:aws:iam::*:role/cfn-*                          ## customer-created CFN execution roles (any path except service-role/)
              - arn:aws:iam::*:role/cloudformation-*               ## alt customer naming for CFN exec roles
              - arn:aws:iam::*:role/service-role/cfn-*             ## CFN exec roles under 'service-role/' path
              - arn:aws:iam::*:role/service-role/cloudformation-*  ## alt naming under 'service-role/' path
            Condition:
              StringEquals:
                iam:PassedToService: cloudformation.amazonaws.com  ## CFN target only

          ## -------------------------------------------------------------------
          ## IAM: discovery + service-linked role creation (writes limited)
          ## -------------------------------------------------------------------
          - Sid: IdentityDiscoveryAndSLR
            Effect: Allow
            Action:
              - iam:Get*                     ## read IAM entities/policies
              - iam:List*                    ## list IAM entities
              - iam:CreateServiceLinkedRole  ## create SLRs when needed
            Resource: "*"

          ## -------------------------------------------------------------------
          ## KMS: read + cryptographic use (Encrypt/Decrypt/DataKey); boundary enforces ViaService constraints
          ## -------------------------------------------------------------------
          - Sid: KmsReadAndUse
            Effect: Allow
            Action:
              - kms:Decrypt                          ## decrypt (service-bound via boundary)
              - kms:DescribeKey                      ## read key metadata
              - kms:Encrypt                          ## encrypt (service-bound via boundary)
              - kms:GenerateDataKey                  ## data key generation (service-bound)
              - kms:GenerateDataKeyWithoutPlaintext  ## envelope key generation
              - kms:GetKeyPolicy                     ## read key policy
              - kms:List*                            ## list keys/aliases/grants
            Resource: "*"

          ## -------------------------------------------------------------------
          ## S3: allow listing all buckets (for discovery/selection in tools/CLI)
          ## -------------------------------------------------------------------
          - Sid: S3ListAllMyBuckets
            Effect: Allow
            Action:
              - s3:ListAllMyBuckets  ## list bucket names in the account
            Resource: "*"

          ## -------------------------------------------------------------------
          ## S3: admin on network-* buckets (no policy edits except via CFN)
          ## -------------------------------------------------------------------
          - Sid: S3NetworkBucketsAdminSafe
            Effect: Allow
            Action:
              - s3:CreateBucket                ## create network-* buckets
              - s3:PutPublicAccessBlock        ## enforce account-level PAB on bucket
              - s3:GetPublicAccessBlock        ## read PAB
              - s3:PutBucketOwnershipControls  ## set bucket owner preferred settings
              - s3:GetBucketOwnershipControls  ## read ownership controls
              - s3:PutBucketVersioning         ## enable versioning
              - s3:GetBucketVersioning         ## read versioning status
              - s3:PutBucketEncryption         ## set default SSE
              - s3:GetEncryptionConfiguration  ## read SSE config
              - s3:PutBucketTagging            ## tag buckets
              - s3:GetBucketTagging            ## read bucket tags
              - s3:GetBucketLocation           ## read region
              - s3:ListBucket                  ## list objects
              - s3:ListBucketVersions          ## list object versions
            Resource:
              - arn:aws:s3:::network-*

          ## -------------------------------------------------------------------
          ## S3: only CFN may set/delete bucket policies (change control)
          ## -------------------------------------------------------------------
          - Sid: S3BucketPolicyViaCloudFormationOnly
            Effect: Allow
            Action:
              - s3:GetBucketPolicy        ## read current bucket policy
              - s3:GetBucketPolicyStatus  ## read public access status
              - s3:PutBucketPolicy        ## set/replace bucket policy
              - s3:DeleteBucketPolicy     ## remove bucket policy
            Resource:
              - arn:aws:s3:::network-*
            Condition:
              ForAnyValue:StringEquals:
                aws:CalledVia: cloudformation.amazonaws.com  ## only when invoked by CFN

          ## -------------------------------------------------------------------
          ## S3: object CRUD in network-* (SSE required; multipart supported)
          ## -------------------------------------------------------------------
          - Sid: S3NetworkObjectsStrict
            Effect: Allow
            Action:
              - s3:PutObject                 ## upload object (single-part)
              - s3:GetObject                 ## download object
              - s3:GetObjectVersion          ## download specific version
              - s3:DeleteObject              ## delete object (current version)
              - s3:DeleteObjectVersion       ## delete a specific version
              - s3:AbortMultipartUpload      ## abort in-progress multipart upload
              - s3:CreateMultipartUpload     ## start multipart upload
              - s3:UploadPart                ## upload object part
              - s3:UploadPartCopy            ## copy part from another object
              - s3:CompleteMultipartUpload   ## finalize multipart upload
              - s3:ListMultipartUploadParts  ## list uploaded parts
            Resource:
              - arn:aws:s3:::network-*/*
            Condition:
              StringEqualsIfExists:
                s3:x-amz-acl: bucket-owner-full-control  ## ensure bucket owner owns objects
                s3:x-amz-server-side-encryption:
                  - AES256   ## allow SSE-S3
                  - aws:kms  ## allow SSE-KMS (see key allowlist below)
              StringLikeIfExists:
                s3:x-amz-server-side-encryption-aws-kms-key-id: arn:aws:kms:*:*:alias/network-*  ## only network-* KMS

## -------------------------------------------------------------------------- ##
## 2 - Utilities & Support

          ## -------------------------------------------------------------------
          ## CloudShell: full access (deny policy blocks exfil/infil/cred inject)
          ## -------------------------------------------------------------------
          - Sid: CloudShellFull
            Effect: Allow
            Action:
              - cloudshell:*  ## full CloudShell console features
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Amazon Q: console chat + Console-to-Code only (no admin)
          ## -------------------------------------------------------------------
          - Sid: AmazonQUseInConsole
            Effect: Allow
            Action:
              - q:GenerateCodeFromCommands  ## console-to-code generation
              - q:GetConversation           ## fetch conversation
              - q:ListConversations         ## list past conversations
              - q:SendMessage               ## send chat message
              - q:StartConversation         ## start chat in console
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Amazon Q Business — chat-only usage (no admin)
          ## -------------------------------------------------------------------
          - Sid: QBusinessChatUseOnly
            Effect: Allow
            Action:
              - qbusiness:Chat      ## interactive chat sessions (async/streaming capable)
              - qbusiness:ChatSync  ## synchronous chat API for request/response calls
            Resource: "*"

          ## -------------------------------------------------------------------
          ## RAM: share lifecycle admin (create/update/delete/associate)
          ## -------------------------------------------------------------------
          - Sid: RamNetworkSharesAdmin
            Effect: Allow
            Action:
              - ram:CreateResourceShare                  ## create a share
              - ram:UpdateResourceShare                  ## update share
              - ram:DeleteResourceShare                  ## delete share
              - ram:AssociateResourceShare               ## attach resources/principals
              - ram:DisassociateResourceShare            ## detach resources/principals
              - ram:AssociateResourceSharePermission     ## attach permission
              - ram:DisassociateResourceSharePermission  ## detach permission
              - ram:AcceptResourceShareInvitation        ## accept invite
              - ram:RejectResourceShareInvitation        ## reject invite
              - ram:Get*                                 ## read shares/permissions
              - ram:List*                                ## list shares/associations
              - ram:TagResource                          ## tag a share
              - ram:UntagResource                        ## untag a share
            Resource: "*"

          ## -------------------------------------------------------------------
          ## RAM: author custom permissions + promote policy-origin shares
          ## -------------------------------------------------------------------
          - Sid: RamPermissionAuthoring
            Effect: Allow
            Action:
              - ram:CreatePermission                       ## create custom permission
              - ram:CreatePermissionVersion                ## add new version
              - ram:SetDefaultPermissionVersion            ## switch default version
              - ram:UpdatePermission                       ## edit permission
              - ram:DeletePermission                       ## delete permission
              - ram:DeletePermissionVersion                ## delete version
              - ram:ReplacePermissionAssociations          ## bulk swap permission on shares
              - ram:ListPermissionAssociations             ## list where permission is used
              - ram:PromotePermissionCreatedFromPolicy     ## promote policy-created perm
              - ram:PromoteResourceShareCreatedFromPolicy  ## promote policy-origin share
              - ram:Get*                                   ## read permissions
              - ram:List*                                  ## list permissions
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Resource Explorer / Groups / Tag APIs: read-only discovery
          ## -------------------------------------------------------------------
          - Sid: DiscoveryAndTagReadOnly
            Effect: Allow
            Action:
              - resource-explorer-2:Search  ## run resource searches
              - resource-explorer-2:Get*    ## read views/index details
              - resource-explorer-2:List*   ## list views/resources
              - resource-groups:Get*        ## read resource groups
              - resource-groups:List*       ## list groups
              - tag:GetResources            ## find resources by tags
              - tag:GetTagValues            ## list tag values
              - tag:GetTagKeys              ## list tag keys
              - account:ListRegions         ## enumerate regions
              - organizations:List*         ## list org structure (read)
            Resource: "*"

          ## -------------------------------------------------------------------
          ## AWS Support: full case management
          ## -------------------------------------------------------------------
          - Sid: SupportFull
            Effect: Allow
            Action:
              - support:*  ## create/update/view cases
            Resource: "*"

## -------------------------------------------------------------------------- ##
## 3 - Observability & Telemetry

          ## -------------------------------------------------------------------
          ## AWS Config: read-only (no rule/recorder changes)
          ## -------------------------------------------------------------------
          - Sid: ConfigReadOnly
            Effect: Allow
            Action:
              - config:BatchGet*   ## batch reads
              - config:Deliver*    ## read delivery info/snapshots
              - config:Describe*   ## describe recorder/rules
              - config:Get*        ## get config/history
              - config:List*       ## list resources/rules
            Resource: "*"

          ## -------------------------------------------------------------------
          ## CloudTrail: read-only (config/status/events lookup)
          ## -------------------------------------------------------------------
          - Sid: CloudTrailReadOnly
            Effect: Allow
            Action:
              - cloudtrail:DescribeTrails       ## list trails and settings
              - cloudtrail:GetEventSelectors    ## read event selectors
              - cloudtrail:GetInsightSelectors  ## read insight selectors
              - cloudtrail:GetTrailStatus       ## read trail status
              - cloudtrail:List*                ## list trails/queries
              - cloudtrail:LookupEvents         ## search events
            Resource: "*"

          ## -------------------------------------------------------------------
          ## CloudWatch Logs: read + query (no admin/policy changes)
          ## -------------------------------------------------------------------
          - Sid: LogsReadAndQuery
            Effect: Allow
            Action:
              - logs:Describe*        ## list log groups/streams
              - logs:Get*             ## get log events/export tasks
              - logs:FilterLogEvents  ## on-the-fly filter query
              - logs:StartQuery       ## start Insights query
              - logs:GetQueryResults  ## retrieve query results
              - logs:List*            ## list queries/log groups
            Resource: "*"

          ## -------------------------------------------------------------------
          ## CloudWatch metrics/alarms: read-only
          ## -------------------------------------------------------------------
          - Sid: CloudWatchReadOnly
            Effect: Allow
            Action:
              - cloudwatch:Describe*  ## describe alarms/metrics
              - cloudwatch:Get*       ## get metrics/alarms data
              - cloudwatch:List*      ## list dashboards/alarms
            Resource: "*"

          ## -------------------------------------------------------------------
          ## X-Ray: read-only (traces, service map)
          ## -------------------------------------------------------------------
          - Sid: XRayReadOnly
            Effect: Allow
            Action:
              - xray:Get*       ## get traces/insights
              - xray:BatchGet*  ## batch trace gets
              - xray:List*      ## list groups/sampling rules
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Health Dashboard: read-only
          ## -------------------------------------------------------------------
          - Sid: HealthReadOnly
            Effect: Allow
            Action:
              - health:Describe*  ## read Health events/impact
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Trusted Advisor: read-only checks
          ## -------------------------------------------------------------------
          - Sid: TrustedAdvisorReadOnly
            Effect: Allow
            Action:
              - trustedadvisor:Describe*  ## describe TA checks
              - trustedadvisor:List*      ## list checks/results
            Resource: "*"

          ## -------------------------------------------------------------------
          ## OAM: link to existing sinks; read state (sink admin denied by boundary)
          ## -------------------------------------------------------------------
          - Sid: ObservabilityAccessManagerLinking
            Effect: Allow
            Action:
              - oam:CreateLink  ## create link to sink
              - oam:DeleteLink  ## delete link
              - oam:Get*        ## read OAM entities
              - oam:List*       ## list links/sinks
              - oam:UpdateLink  ## update link config
            Resource: "*"

## -------------------------------------------------------------------------- ##
## 4 - Systems Management

          ## -------------------------------------------------------------------
          ## SSM: sessions/RunCommand (tag-gated), docs/params, minimal Automation
          ## -------------------------------------------------------------------
          - Sid: SsmCoreOps
            Effect: Allow
            Action:
              - ssm:Describe*             ## read instance/doc/compliance info
              - ssm:List*                 ## list docs/instances/commands
              - ssm:Get*                  ## get parameters/docs/outputs
              - ssm:StartSession          ## start Session Manager session
              - ssm:ResumeSession         ## resume session
              - ssm:TerminateSession      ## end session
              - ssm:SendCommand           ## RunCommand dispatch
              - ssm:CancelCommand         ## cancel command
              - ssm:GetCommandInvocation  ## fetch command output
            Resource: "*"
            Condition:
              StringEquals:
                ssm:resourceTag/NetworkManaged: "true"  ## only our instances
              StringLikeIfExists:
                ssm:DocumentName:
                  - AWS-RunShellScript       ## allow AWS basic shell
                  - AWS-RunPowerShellScript  ## allow AWS PowerShell
                  - network-*                ## allow our runbooks

          ## -------------------------------------------------------------------
          ## SSM — Associations & Maintenance Windows: full lifecycle (create/update/delete/register/describe)
          ## -------------------------------------------------------------------
          - Sid: SsmAssocAndMW
            Effect: Allow
            Action:
              - ssm:*Association          ## State Manager associations: create/update/delete/describe/list
              - ssm:*MaintenanceWindow*   ## Maintenance Windows: create/update/delete/register target/task; describe/list
            Resource: "*"

          ## -------------------------------------------------------------------
          ## SSM — Parameter Store: manage only your namespace (/network/...)
          ## -------------------------------------------------------------------
          - Sid: SsmParametersNetworkPath
            Effect: Allow
            Action:
              - ssm:*Parameter*  ## Put/Get/Delete/Label/Describe/List parameters & versions under /network/
            Resource: arn:aws:ssm:*:*:parameter/network/*

          ## -------------------------------------------------------------------
          ## SSM — Your runbooks (Documents): authoring/admin for network-* docs
          ## -------------------------------------------------------------------
          - Sid: SsmDocsNetwork
            Effect: Allow
            Action:
              - ssm:*Document*  ## CreateDocument/UpdateDocument/UpdateDocumentDefaultVersion/DeleteDocument (and related describe/list)
            Resource: arn:aws:ssm:*:*:document/network-*

          ## -------------------------------------------------------------------
          ## SSM — Global document read: fetch/inspect any SSM document
          ## -------------------------------------------------------------------
          - Sid: SsmDocsRead
            Effect: Allow
            Action:
              - ssm:GetDocument           ## retrieve document content (any scope)
              - ssm:DescribeDocument      ## read document metadata/default version
              - ssm:ListDocuments         ## enumerate documents
              - ssm:ListDocumentVersions  ## list versions of a document
            Resource: "*"

          ## -------------------------------------------------------------------
          ## SSM — Automation: start executions only for your runbooks; caller creds only
          ## -------------------------------------------------------------------
          - Sid: SsmAutomationStartNetworkDocsOnly
            Effect: Allow
            Action:
              - ssm:StartAutomationExecution        ## kick off Automation execution for allowed docs
            Resource:
              - arn:aws:ssm:*:*:document/network-*  ## only your network-* runbooks
            Condition:
              "Null":
                ssm:AutomationAssumeRole: "true"    ## require NO AutomationAssumeRole (runs with caller context)

          ## -------------------------------------------------------------------
          ## SSM — Automation results: read back executions/steps
          ## -------------------------------------------------------------------
          - Sid: SsmAutomationReadResults
            Effect: Allow
            Action:
              - ssm:GetAutomationExecution            ## fetch a specific execution
              - ssm:DescribeAutomationExecutions      ## list executions
              - ssm:DescribeAutomationStepExecutions  ## list steps within an execution
              - ssm:ListAutomationExecutions          ## alternate listing API
            Resource: "*"
## -------------------------------------------------------------------------- ##
## 5 - Networking Services

          ## -------------------------------------------------------------------
          ## Secrets Manager: read-only (value + metadata)
          ## -------------------------------------------------------------------
          - Sid: SecretsManagerRead
            Effect: Allow
            Action:
              - secretsmanager:GetSecretValue        ## read secret value
              - secretsmanager:DescribeSecret        ## read secret metadata
              - secretsmanager:ListSecrets           ## list secrets
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Core networking admin across services (broad control plane)
          ## -------------------------------------------------------------------
          - Sid: NetworkingAdmin
            Effect: Allow
            Action:
              - ec2:*                   ## all EC2 (VPC/Subnets/NACLs/IGWs/TGW/etc.)
              - elasticloadbalancing:*  ## all ELB/ALB/NLB
              - globalaccelerator:*     ## all GA
              - network-firewall:*      ## all AWS Network Firewall
              - networkmanager:*        ## all Network Manager
              - route53resolver:*       ## all Route 53 Resolver
              - vpc-lattice:*           ## all VPC Lattice
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Route 53 + ARC: full admin (authoritative DNS, domains, ARC)
          ## -------------------------------------------------------------------
          - Sid: Route53AndARCAdmin
            Effect: Allow
            Action:
              - route53:*                          ## all hosted zones/records
              - route53profiles:*                  ## Route 53 Profiles
              - route53-recovery-control-config:*  ## ARC routing controls config
              - route53-recovery-readiness:*       ## ARC readiness checks
              - route53-recovery-cluster:*         ## ARC cluster APIs
              - arc-zonal-shift:*                  ## Zonal shift controls
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Route53 Domains (registrar): read-only visibility
          ## -------------------------------------------------------------------
          - Sid: Route53DomainsReadOnly
            Effect: Allow
            Action:
              - route53domains:ListDomains              ## list registered domains
              - route53domains:GetDomainDetail          ## read domain contacts/DNS/privacy
              - route53domains:ListOperations           ## list registrar ops history
              - route53domains:GetOperationDetail       ## read specific op detail
              - route53domains:ListTagsForDomain        ## read domain tags
              - route53domains:ListPrices               ## read pricing
              - route53domains:CheckDomainAvailability  ## availability checks
              - route53domains:GetDomainSuggestions     ## suggestions
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Direct Connect: discovery only (no lifecycle)
          ## -------------------------------------------------------------------
          - Sid: DirectConnectReadOnly
            Effect: Allow
            Action:
              - directconnect:Describe*       ## read DX connections/virtual interfaces
              - directconnect:List*           ## list resources
              - directconnect:ViewConnections ## legacy read view
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Service Quotas: read everything (safe)
          ## -------------------------------------------------------------------
          - Sid: ServiceQuotasRead
            Effect: Allow
            Action:
              - servicequotas:Get*   ## read quota values, defaults, templates, and individual requests
              - servicequotas:List*  ## list services, quotas, change requests, and template entries
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Service Quotas: request increases (network-scoped only)
          ## -------------------------------------------------------------------
          - Sid: ServiceQuotasIncreaseNetworkScoped
            Effect: Allow
            Action:
              - servicequotas:RequestServiceQuotaIncrease  ## submit increase request for a specific quota
            Resource: "*"
            Condition:
              StringEquals:
                servicequotas:service:    ## restrict requests to these services only
                  - ec2                   ## VPC/subnets/IGWs/NATGWs/EIPs/ENIs/SecurityGroups per region/AZ
                  - elasticloadbalancing  ## ALB/NLB counts, listeners, target groups, rules
                  - route53               ## hosted zones, health checks, traffic policies
                  - route53resolver       ## inbound/outbound endpoints, rules, IPs per endpoint
                  - directconnect         ## connections, LAGs, virtual interfaces, hosted VIFs
                  - globalaccelerator     ## accelerators, listeners, endpoint groups
                  - network-firewall      ## firewalls, policies, rule groups, per-Region limits
                  - vpc-lattice           ## service networks, services, auth policies, targets
                  - networkmanager        ## global networks, sites, TGW/R53 integrations
                  - ram                   ## resource shares, associations, permissions

## -------------------------------------------------------------------------- ##
## 5 - Networking Services

          ## -------------------------------------------------------------------
          ## Secrets Manager: read-only (value + metadata)
          ## -------------------------------------------------------------------
          - Sid: SecretsManagerRead
            Effect: Allow
            Action:
              - secretsmanager:GetSecretValue        ## read secret value
              - secretsmanager:DescribeSecret        ## read secret metadata
              - secretsmanager:ListSecrets           ## list secrets
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Direct Connect: discovery only (no lifecycle)
          ## -------------------------------------------------------------------
          - Sid: DirectConnectReadOnly
            Effect: Allow
            Action:
              - directconnect:Describe*       ## read DX connections/virtual interfaces
              - directconnect:List*           ## list resources
              - directconnect:ViewConnections ## legacy read view
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Service Quotas: read everything (safe)
          ## -------------------------------------------------------------------
          - Sid: ServiceQuotasRead
            Effect: Allow
            Action:
              - servicequotas:Get*   ## read quota values, defaults, templates, and individual requests
              - servicequotas:List*  ## list services, quotas, change requests, and template entries
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Service Quotas: network-scoped requests + template mgmt (covers VPC endpoints, NAT GWs, RTs, SGs, etc.)
          ## -------------------------------------------------------------------
          - Sid: ServiceQuotasNetworkRequestsFull
            Effect: Allow
            Action:
              - servicequotas:RequestServiceQuotaIncrease                ## file increase requests
              - servicequotas:PutServiceQuotaIncreaseRequestIntoTemplate ## manage quota template entries
              - servicequotas:DeleteServiceQuotaIncreaseRequestFromTemplate
              - servicequotas:TagResource
              - servicequotas:UntagResource
            Resource: "*"
            Condition:
              StringEquals:
                servicequotas:service:
                  - ec2                   ## VPCs, subnets, RTs, NAT, ENIs, SGs, **VPC endpoints**, etc.
                  - vpc                   ## some VPC quotas surface under this code in some regions
                  - elasticloadbalancing  ## ALB/NLB counts, listeners, target groups, rules
                  - route53               ## hosted zones, health checks, traffic policies
                  - route53resolver       ## inbound/outbound endpoints, rules, IPs per endpoint
                  - directconnect         ## connections, LAGs, VIFs
                  - globalaccelerator     ## accelerators, listeners, endpoint groups
                  - network-firewall      ## firewalls, policies, rule groups
                  - vpc-lattice           ## service networks, services, auth policies, targets
                  - networkmanager        ## global networks, sites, TGW/R53 integrations
                  - ram                   ## resource shares, associations, permissions

          ## -------------------------------------------------------------------
          ## Service Quotas: organization-wide quota template toggle (OPTIONAL)
          ## Remove this block if template toggles should be centralized elsewhere.
          ## -------------------------------------------------------------------
          - Sid: ServiceQuotasTemplateToggle
            Effect: Allow
            Action:
              - servicequotas:AssociateServiceQuotaTemplate
              - servicequotas:DisassociateServiceQuotaTemplate
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Core networking admin across services (broad control plane)
          ## -------------------------------------------------------------------
          - Sid: NetworkingAdmin
            Effect: Allow
            Action:
              - ec2:*                   ## all EC2 (VPC/Subnets/NACLs/IGWs/TGW/etc.)
              - elasticloadbalancing:*  ## all ELB/ALB/NLB
              - globalaccelerator:*     ## all GA
              - network-firewall:*      ## all AWS Network Firewall
              - networkmanager:*        ## all Network Manager
              - route53resolver:*       ## all Route 53 Resolver
              - vpc-lattice:*           ## all VPC Lattice
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Route 53 + ARC: full admin (authoritative DNS, domains, ARC)
          ## -------------------------------------------------------------------
          - Sid: Route53AndARCAdmin
            Effect: Allow
            Action:
              - route53:*                          ## all hosted zones/records
              - route53profiles:*                  ## Route 53 Profiles
              - route53-recovery-control-config:*  ## ARC routing controls config
              - route53-recovery-readiness:*       ## ARC readiness checks
              - route53-recovery-cluster:*         ## ARC cluster APIs
              - arc-zonal-shift:*                  ## Zonal shift controls
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Route53 Domains (registrar): read-only visibility
          ## -------------------------------------------------------------------
          - Sid: Route53DomainsReadOnly
            Effect: Allow
            Action:
              - route53domains:ListDomains              ## list registered domains
              - route53domains:GetDomainDetail          ## read domain contacts/DNS/privacy
              - route53domains:ListOperations           ## list registrar ops history
              - route53domains:GetOperationDetail       ## read specific op detail
              - route53domains:ListTagsForDomain        ## read domain tags
              - route53domains:ListPrices               ## read pricing
              - route53domains:CheckDomainAvailability  ## availability checks
              - route53domains:GetDomainSuggestions     ## suggestions
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Edge protection (WAFv2/Shield): read-only
          ## -------------------------------------------------------------------
          - Sid: EdgeProtectionReadOnly
            Effect: Allow
            Action:
              - wafv2:Get*        ## get web ACLs/resources
              - wafv2:List*       ## list web ACLs/resources
              - shield:Describe*  ## read Shield protections/events
              - shield:List*      ## list protections
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Internet Monitor & VPC Network Monitor: admin
          ## -------------------------------------------------------------------
          - Sid: InternetAndNetworkMonitorAdmin
            Effect: Allow
            Action:
              - internetmonitor:*  ## manage Internet Monitor
              - networkmonitor:*   ## manage VPC Network Monitor
            Resource: "*"

## -------------------------------------------------------------------------- ##
## 6 - Security & Compliance

          ## -------------------------------------------------------------------
          ## IAM Access Analyzer: read + policy validation
          ## -------------------------------------------------------------------
          - Sid: AccessAnalyzerReadOnlyAndValidation
            Effect: Allow
            Action:
              - access-analyzer:Get*
              - access-analyzer:List*
              - access-analyzer:ValidatePolicy
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Security services: read-only (Hub/GuardDuty/Inspector)
          ## -------------------------------------------------------------------
          - Sid: SecurityServicesReadOnly
            Effect: Allow
            Action:
              - guardduty:Get*
              - guardduty:List*
              - inspector2:Get*
              - inspector2:List*
              - securityhub:Describe*
              - securityhub:Get*
              - securityhub:List*
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Amazon Macie: read-only
          ## -------------------------------------------------------------------
          - Sid: MacieReadOnly
            Effect: Allow
            Action:
              - macie2:Describe*
              - macie2:Get*
              - macie2:List*
            Resource: "*"

          ## -------------------------------------------------------------------
          ## AWS Firewall Manager: read-only
          ## -------------------------------------------------------------------
          - Sid: FirewallManagerReadOnly
            Effect: Allow
            Action:
              - fms:Get*
              - fms:List*
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Amazon Security Lake: read-only
          ## -------------------------------------------------------------------
          - Sid: SecurityLakeReadOnly
            Effect: Allow
            Action:
              - securitylake:Get*
              - securitylake:List*
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Amazon Detective: read-only
          ## -------------------------------------------------------------------
          - Sid: DetectiveReadOnly
            Effect: Allow
            Action:
              - detective:Get*
              - detective:List*
              - detective:Describe*
            Resource: "*"

          ## -------------------------------------------------------------------
          ## AWS Audit Manager: read-only
          ## -------------------------------------------------------------------
          - Sid: AuditManagerReadOnly
            Effect: Allow
            Action:
              - auditmanager:Get*
              - auditmanager:List*
              - auditmanager:Describe*
            Resource: "*"

          ## -------------------------------------------------------------------
          ## EventBridge & Scheduler: read-only visibility
          ## -------------------------------------------------------------------
          - Sid: EventsAndSchedulerReadOnly
            Effect: Allow
            Action:
              - events:Describe*
              - events:Get*
              - events:List*
              - scheduler:Describe*
              - scheduler:Get*
              - scheduler:List*
            Resource: "*"

          ## -------------------------------------------------------------------
          ## EventBridge Pipes: read-only visibility
          ## -------------------------------------------------------------------
          - Sid: EventBridgePipesReadOnly
            Effect: Allow
            Action:
              - pipes:DescribePipe
              - pipes:ListPipes
              - pipes:ListTagsForResource
            Resource: "*"

## -------------------------------------------------------------------------- ##
## 7 - Development — Source & Orchestration

          ## -------------------------------------------------------------------
          ## IaC: deploy with CloudFormation (create/update stacks & change sets)
          ## -------------------------------------------------------------------
          - Sid: CloudFormationDeploy
            Effect: Allow
            Action:
              - cloudformation:CreateStack
              - cloudformation:UpdateStack
              - cloudformation:CreateChangeSet
              - cloudformation:ExecuteChangeSet
              - cloudformation:DeleteChangeSet
              - cloudformation:Describe*
              - cloudformation:Get*
              - cloudformation:List*
              - cloudformation:ValidateTemplate
              - cloudformation:DetectStackDrift
              - cloudformation:DetectStackResourceDrift
              - cloudformation:CancelUpdateStack
              - cloudformation:ContinueUpdateRollback
            Resource: "*"

            ## -------------------------------------------------------------------
            ## SCM: CodeCommit read/write (Git pull/push + basic PR ops)
            ## -------------------------------------------------------------------
            - Sid: CodeCommitReadWrite
              Effect: Allow
              Action:
                - codecommit:Get*
                - codecommit:List*
                - codecommit:GitPull
                - codecommit:GitPush
                - codecommit:CreatePullRequest
                - codecommit:UpdatePullRequest*
                - codecommit:MergePullRequestByFastForward
                - codecommit:MergePullRequestBySquash
                - codecommit:MergePullRequestByThreeWay
              Resource: "*"

          ## -------------------------------------------------------------------
          ## CI/CD Orchestration: operate CodePipeline executions (no pipeline admin)
          ## -------------------------------------------------------------------
          - Sid: CodePipelineOperations
            Effect: Allow
            Action:
              - codepipeline:Get*
              - codepipeline:List*
              - codepipeline:StartPipelineExecution
              - codepipeline:StopPipelineExecution
              - codepipeline:RetryStageExecution
              - codepipeline:PutApprovalResult
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Messaging — SNS publish/read
          ## -------------------------------------------------------------------
          - Sid: SnsPublishAndRead
            Effect: Allow
            Action:
              - sns:Publish
              - sns:Get*
              - sns:List*
              - sns:ConfirmSubscription
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Messaging — SNS minimal writes (scoped to network-*)
          ## -------------------------------------------------------------------
          - Sid: SnsOpsMinimalWrites
            Effect: Allow
            Action:
              - sns:Subscribe
              - sns:Unsubscribe
            Resource:
              - arn:aws:sns:*:*:network-*
              - arn:aws:sns:*:*:network-*:*

          ## -------------------------------------------------------------------
          ## Messaging — SQS consume/read
          ## -------------------------------------------------------------------
          - Sid: SqsConsumeAndRead
            Effect: Allow
            Action:
              - sqs:ReceiveMessage
              - sqs:SendMessage
              - sqs:GetQueueAttributes
              - sqs:GetQueueUrl
              - sqs:ListQueues
            Resource: "*"

          ## -------------------------------------------------------------------
          ## Messaging — SQS minimal writes (scoped to network-*)
          ## -------------------------------------------------------------------
          - Sid: SqsOpsMinimalWrites
            Effect: Allow
            Action:
              - sqs:DeleteMessage
              - sqs:ChangeMessageVisibility
            Resource:
              - arn:aws:sqs:*:*:network-*

## -------------------------------------------------------------------------- ##
## 8 - Development — Workflow & Deployment

          ## -------------------------------------------------------------------
          ## CI: operate CodeBuild builds (start/stop/retry, read state)
          ## -------------------------------------------------------------------
          - Sid: CodeBuildOperations
            Effect: Allow
            Action:
              - codebuild:BatchGet*
              - codebuild:List*
              - codebuild:StartBuild
              - codebuild:StopBuild
              - codebuild:RetryBuild
            Resource: "*"

          ## -------------------------------------------------------------------
          ## CD: operate CodeDeploy deployments (create/stop, read state)
          ## -------------------------------------------------------------------
          - Sid: CodeDeployOperations
            Effect: Allow
            Action:
              - codedeploy:Get*
              - codedeploy:List*
              - codedeploy:CreateDeployment
              - codedeploy:StopDeployment
            Resource: "*"

## -------------------------------------------------------------------------- ##
